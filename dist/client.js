"querySelector"in document&&"localStorage"in window&&"addEventListener"in window&&(document.location.hash&&"#why"!==document.location.hash&&"#how-it-works"!==document.location.hash&&(document.location.href=""),ClassUtil.replace(document.body,"nojs","js"),ClassUtil.add(document.getElementsByTagName("main")[0],"spa"),window.onload=function(){function e(e){e.preventDefault(),e.stopPropagation();var t=document.getElementById("input__file");t.files.length&&i(t.files[0])}function t(e){r()}function n(e){document.location.href="#"+e}function a(){return{K:document.getElementById("input__k").value,space:document.getElementById("input__space").value}}function i(e,t){n("working");var a=new FileReader;a.onload=function(e){var t=new Image;t.onload=o,t.src=e.target.result},a.readAsDataURL(e)}function o(e){var t=a(),i=e.target,o=document.getElementById("canvas"),c=document.getElementById("workspace"),r=window.innerWidth?window.innerWidth:i.width;d(i,c,300);var u=c.getContext("2d"),s=u.getImageData(0,0,c.width,c.height).data,m=Swatchmaker.extractPalette(s,t.K,t.space);l(m,o),d(i,o,r),n("output")}function l(e,t){var n,a,i=document.getElementById("palette");for(i.innerHTML="",a=0;a<e.length;a+=1)n=document.createElement("span"),n.className="swatch",n.style.backgroundColor="rgb("+e[a][0]+", "+e[a][1]+", "+e[a][2]+")",i.appendChild(n)}function d(e,t,n){var a=t.getContext("2d"),i=e.width>e.height;t.width=i?n:e.width/e.height*n,t.height=i?e.height/e.width*n:n,a.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height)}function c(){for(var e=document.querySelectorAll(".hash"),t=0;t<e.length;t++)e[t].href=e[t].href.replace(/\/([^\/]+)$/,"#$1")}function r(){var e=document.getElementById("input__submit"),t=document.getElementById("input__file"),n=document.getElementById("input__file__label"),a=n.parentNode,i="input__file--selected-error",o="input__file--selected";t.files.length?(n.innerHTML=t.files[0].name,null!==t.files[0].type.match(/^image\//)?(console.log("Image"),ClassUtil.replace(a,i,o),e.disabled=!1):(console.log("Error"),e.disabled=!0,ClassUtil.replace(a,o,i))):(console.log("Neutral"),e.disabled=!0,ClassUtil.remove(a,o),ClassUtil.remove(a,i))}var u=document.getElementById("form");u.addEventListener("submit",e,!1);var s=document.getElementById("input__file");s.addEventListener("change",t,!1);var m=document.getElementById("input__file__label");m.addEventListener("keypress",function(e){if(13===e.keyCode){var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});s.dispatchEvent(t)}}),c(),r()});