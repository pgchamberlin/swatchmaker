document.location.hash&&"#why"!==document.location.hash&&"#how-it-works"!==document.location.hash&&(document.location.href=""),"querySelector"in document&&"localStorage"in window&&"addEventListener"in window&&function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}()&&(ClassUtil.replace(document.body,"nojs","js"),ClassUtil.add(document.getElementsByTagName("main")[0],"spa"),window.onload=function(){function e(e){e.preventDefault(),e.stopPropagation();var t=document.getElementById("input__file");t.files.length&&r(t.files[0])}function t(e){document.location.href="#"+e}function n(){return{K:document.getElementById("input__k").value,sample:document.getElementById("input__sample").value,space:document.getElementById("input__space").value}}function r(e,n){t("working");var r=new FileReader;r.onload=function(e){var t=new Image;t.onload=a,t.src=e.target.result},r.readAsDataURL(e)}function a(e){var r=n(),a=e.target,l=document.getElementById("canvas"),u=document.getElementById("workspace"),i=window.innerWidth?window.innerWidth:a.width;g(a,u,300);var c=u.getContext("2d"),d=o(r,c.getImageData(0,0,u.width,u.height).data),s=Swatchmaker.extractPalette(d,r.K,r.space);m(s,l),g(a,l,i),t("output")}function o(e,t){switch(e.sample){case"BRIGHT":return c(t);case"MID":return d(t);case"DARK":return s(t);case"SATURATED":return h(t);default:return t}}function l(e){for(var t={lookup:{},arr:[]},n=e.length,r=0,a=0;a<n;a+=4)r=e[a]+e[a+1]+e[a+2],t.lookup[r]=t.lookup[r]||[],t.lookup[r].push(a),t.arr.indexOf(r)===-1&&t.arr.push(r);return t.arr.sort(function(e,t){return t-e}),t}function u(e){for(var t,n,r,a,o,l={lookup:{},arr:[]},u=e.length,i=0;i<u;i+=4)t=Math.min(e[i],e[i+1],e[i+2]),n=Math.max(e[i],e[i+1],e[i+2]),r=n-t,o=(t+n)/2,a=0===r?0:o<.5?r/(n+t):r/(2-n-t),l.lookup[a]=l.lookup[a]||[],l.lookup[a].push(i),l.arr.indexOf(a)===-1&&l.arr.push(a);return l.arr.sort(function(e,t){return t-e}),l}function i(e,t,n){for(var r=[],a=e.length,o=0;o<a;o++)for(var l=t[e[o]].length,u=0;u<l;u++)r.push(n[t[e[o]][u]]),r.push(n[t[e[o]][u]+1]),r.push(n[t[e[o]][u]+2]),r.push(255);return r}function c(e){var t=l(e),n=t.arr.slice(0,Math.floor(t.arr.length/2));return i(n,t.lookup,e)}function d(e){var t=l(e),n=t.arr.slice(Math.floor(t.arr.length/4),Math.floor(t.arr.length/4*3));return i(n,t.lookup,e)}function s(e){var t=l(e),n=t.arr.slice(Math.floor(t.arr.length/2));return i(n,t.lookup,e)}function h(e){var t=u(e),n=t.arr.slice(0,Math.floor(t.arr.length/2));return i(n,t.lookup,e)}function m(e,t){var n,r,a=document.getElementById("palette");for(a.innerHTML="",r=0;r<e.length;r+=1)n=document.createElement("span"),n.className="swatch",n.style.backgroundColor="rgb("+e[r][0]+", "+e[r][1]+", "+e[r][2]+")",swatchValue=document.createElement("span"),swatchValue.className="swatch__value",swatchValue.style.color=f(e[r]),swatchValue.innerHTML=p(e[r]),n.appendChild(swatchValue),a.appendChild(n)}function f(e){var t=e.reduce(function(e,t){return e+t},0),n=Math.round((t>384?t-384:t+384)/3),r=[n,n,n];return p(r)}function p(e){return"#"+e.map(function(e){var t=e.toString(16);return 1==t.length?"0"+t:t}).join("")}function g(e,t,n){var r=t.getContext("2d"),a=e.width>e.height;t.width=a?n:e.width/e.height*n,t.height=a?e.height/e.width*n:n,r.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height)}function v(){for(var e=document.querySelectorAll(".hash"),t=0;t<e.length;t++)e[t].href="#"+e[t].href.match(/\/[^\/]+$/)[0].substr(1)}function w(){var e=document.getElementById("input__submit"),t=document.getElementById("input__file"),n=document.getElementById("input__file__label"),r=n.parentNode,a="input__file--selected-error",o="input__file--selected";t.files.length?(n.innerHTML=t.files[0].name,null!==t.files[0].type.match(/^image\//)?(ClassUtil.replace(r,a,o),e.disabled=!1):(e.disabled=!0,ClassUtil.replace(r,o,a))):(e.disabled=!0,ClassUtil.remove(r,o),ClassUtil.remove(r,a))}function _(){var t=document.getElementById("form");t.addEventListener("submit",e,!1);var n=document.getElementById("input__file");n.addEventListener("change",w,!1);var r=document.getElementById("input__file__label");r.addEventListener("keypress",function(e){if(13===e.keyCode){var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(t)}})}_(),v(),w()});