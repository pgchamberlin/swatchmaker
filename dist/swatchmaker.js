!function(r,t){"object"==typeof module&&module.exports?module.exports=t():r.Swatchmaker=t()}(this,function(){function r(r,n,u){var a=e(r,u),f=t(a,n,1e-4),h=f.map(function(r){return o(r,u)});return h}function t(r,t,o){for(var e,a,f,h=r.length/4,c=[],s=[];c.length<t;){for(e=4*Math.floor(Math.random()*(h-1)),a=!1,f=0;f<t;f++)if(s[f]&&e===s[f]){a=!0;break}a||(s.push(e),c.push([r[e],r[e+1],r[e+2]]))}for(var i,p,l,v,d,m,M;;){for(M=[],f=0;f<t;f++)M.push([]);var g;for(f=0;f<h;f++){g=4*f;for(var b=[r[g],r[g+1],r[g+2]],w=1e7,S=0,k=0;k<t;k++){var x=u(b,c[k]);x<w&&(w=x,S=k)}M[S].push(b)}for(i=0,f=0;f<t;f++)p=c[f],l=M[f],v=n(l,3),d=v,m=u(p,v),c[f]=d,i=i>m?i:m;if(i<o)break}return c=c.map(function(r){return r.map(function(r){return Math.floor(r)})})}function n(r,t){var n,u,o=[],e=0,a=r.length;for(n=0;n<t;n++)o.push(0);for(n=0;n<a;n++)for(e++,u=0;u<t;u++)o[u]+=r[n][u];for(n=0;n<t;n++)0!==e?o[n]=o[n]/e:o[n]=0;return o}function u(r,t){var n,u,o=0;for(n=0;n<3;n++)u=r[n]-t[n],o+=Math.pow(u,2);return Math.sqrt(o)}function o(r,t){switch(t){case"YUV":return a(r,h);case"HSL":return a(r,hslToRgb);default:return r}}function e(r,t){switch(t){case"YUV":return a(r,f);case"HSL":return a(r,rgbToHSL);default:return r}}function a(r,t){for(var n,u,o,e,a=[],f=r.length,h=0;h<f;h+=4)n=r[h],u=r[h+1],o=r[h+2],e=t(n,u,o),a.push(Math.round(e[0])),a.push(Math.round(e[1])),a.push(Math.round(e[2])),r[h+3]&&a.push(r[h+3]);return a}function f(r,t,n){var u=.299*r+.587*t+.114*n,o=.492*(n-u),e=.877*(r-u);return[u,o,e]}function h(r,t,n){var u=r+1.14*n,o=r-.395*t-.581*n,e=r+2.032*t;return[u,o,e]}return{extractPalette:r}});